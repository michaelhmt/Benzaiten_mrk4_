# coding=utf8
import os
import sys
import json
from pprint import pprint

# env settings
def set_env():
    env_dir = os.path.dirname(os.getcwd())
    sys.path.append(env_dir)
    print("this is env dir: ", env_dir)
set_env()
import Site_custom
env_object = Site_custom.env()



#site packages
import pymongo



class Database_Class(object):
    def __init__(self, databasename):
        self.client = pymongo.MongoClient("mongodb://192.168.50.228:49156")
        self.database_name = "{0}".format(databasename)
        self.database = self.client[self.database_name]

        self.fail_log_location = env_object.upload_fails
        self.fail_log = self.open_log()

    def open_log(self):
        # make the log if it does'nt exist
        if not os.path.exists(self.fail_log_location):
            if self.debug_mode:
                print("******: making log")
            with open(self.fail_log_location, 'a+') as i_log:
                blank_log =[]
                json.dump(blank_log, i_log, indent=4)

        # get the log data
        with open(self.fail_log_location) as log_file:
            data = json.load(log_file)

        return data


    def add_to_log(self, data_to_add):
        """
        give this function a list with with [Author, link, Title]
        :param metadata_to_add:
        :return:
        """

        with open(self.fail_log_location, 'r+' ) as f_log:
            current_data = json.load(f_log)
            current_data.append(data_to_add)
            f_log.seek(0)
            json.dump(current_data, f_log, indent=4)


    def add_to_database(self,itemToAdd, targetCollection, print_IDs = True):

        if type(targetCollection) != str:
            print("collection needs to be a string")
            return None

        database_collection = self.database[targetCollection]

        print("adding to db")
        if type(itemToAdd) == list and len(itemToAdd) > 0:
            # assume it a list of dicts so add many to Db
            if len(itemToAdd) == 1:
                single = itemToAdd[0]
                try:
                    print("Adding a dict that was in a list")
                    add_op = database_collection.insert_one(single)
                    #if print_IDs:
                        #print(add_op.inserted_ids)
                    print("sucessfuly added one item the database")
                    return True
                except Exception as e:
                    print("*************************************************")
                    print("well that did'nt work, got this error   {}".format(e))
                    print("Adding data to fail log.")
                    print("*************************************************")
                    self.add_to_log(single)

            try:
                print("Adding a list of dicts")
                add_op = database_collection.insert_many(itemToAdd)
                if print_IDs:
                    print(add_op.inserted_ids)
                return True
            except Exception as e:
                print("*************************************************")
                print("well that did'nt work, got this error   {}".format(e))
                print("Adding data to fail log.")
                print("*************************************************")
                self.add_to_log(single)

        else:
            try:
                print("Adding one dict")
                add_op = database_collection.insert_one(itemToAdd)
                if print_IDs:
                    print(add_op.inserted_id)
                print("sucessfuly added one item the database")
                return True
            except Exception as e:
                print("*************************************************")
                print("well that did'nt work, got this error   {}".format(e))
                print("Adding data to fail log.")
                print("*************************************************")
                self.add_to_log(single)


    def get_complete_collection(self, collection_to_get):

        data_base_contents = self.database[collection_to_get]
        data = data_base_contents.find()

        retunable_data = []

        for collection in data:
            del (collection['_id'])
            retunable_data.append(collection)
        return retunable_data



# testpackage = [{'MetaData': {'Link': '/works/35251492', 'Title': "dancin' 'round the kitchen in the refrigerator light", 'Author': 'pagkilala', 'Tags': ['test_tag'], 'Story Summary': ["Test summary"], 'Language': 'English', 'Chapters': '1'}, 'Content': {'1': ["TEST_CONTENT"]}},{'MetaData': {'Link': '/works/35090542', 'Title': 'Long Past Dawn', 'Author': 'zerocaloriemonster', 'Tags': ['Shingeki no Kyojin | Attack on Titan', 'Graphic Depictions Of Violence', 'Levi Ackerman/Reader', 'Levi Ackerman/You', 'Mikasa Ackerman/Eren Yeager', 'Moblit Berner/Hange Zoë', 'Reader', 'Levi Ackerman', 'Eren Yeager', 'Mikasa Ackerman', 'Armin Arlert', 'Erwin Smith', 'Hange Zoë', 'Mike Zacharias', 'Nanaba (Shingeki no Kyojin)', 'Reiner Braun', 'Bertolt Hoover', 'Annie Leonhart', 'Gelgar (Shingeki no Kyojin)', 'Nile Dok', 'Sasha Blouse', 'Connie Springer', 'Krista Lenz | Historia Reiss', 'Ymir (Shingeki no Kyojin)', 'Yelena (Shingeki no Kyojin)', 'Onyankopon (Shingeki no Kyojin)', 'Zeke Yeager', 'Pieck Finger', 'Petra Ral', 'Oluo Bozado', 'Gunther Schultz', 'Eld Jinn', 'Rico Brzenska', 'Mitabi Jarnach', 'Ian Dietrich', 'Grisha Yeager', 'Carla Yeager', 'Jean Kirstein', 'Enemies to Lovers', 'Enemies to Friends to Lovers', 'Blood and Gore', 'Violence', 'Implied/Referenced Child Abuse', 'Abuse', 'Slow Burn', 'Slow Build', 'Slow Romance', 'Like really fucking slow', 'annoyingly slow', 'Jealousy', 'Rivals to Lovers', 'Rivals With Benefits', 'Angst', 'Hurt/Comfort', 'Emotional Hurt/Comfort', 'Humor', 'Angst and Humor', 'Sarcasm', 'yn is kinda an asshole'], 'Story Summary': ["\nSome people are destined for each other, and some people happen to meet. Some people's eyes spark at the first eye contact and some people's burn in hatred. Some people are made to work side by side, and some people are forced to endure the presence of each other. Some people love each other, and some people try to hide their feelings behind prejudice.\n\n \n"], 'Language': 'English', 'Chapters': '4'}, 'Content': {'1': ['\nChapter Text\nThe first time she felt the burning sensation of a palm meeting her cheek was when she was around four. She sat with her family at the dinner table and slurped her soup, the oil glistening with every spoon she scooped. It was rather quiet that day, her mother sat to her right, her father to the left, unlike the other days, they didn\'t talk. At all. YN\'s little fingers slipped against the spoon, and the spoon fell, splashing into the soup. For a quick moment, she could only see the drops of liquid shining from her father\'s hand closed in a fist. She felt his open palm sling against her rosy cheeks, but she couldn\'t let out a cry, scared she might get another slap, so she just watched as her soup got saltier and saltier with every teardrop.Mr. Vögel was a Military Policeman, was wealthy, had status, his eyes never once looked at the ground. He worked hard, took his job seriously, patrolled the city, and dedicated his heart to the king. All this, until he touched a bottle of alcohol. It wasn\'t a rare occurrence that he would come home late, smelling of booze. Then he would argue with his wife about the shitty life he was living, about his shitty wife and job he had, and about the shitty kid he had to take care of.\nBut his life wasn\'t shitty at all. Mitras was the biggest city of Wall Sina, it gave home to the elite, the wealthy, the people in the Military Police, and of course the King. It seemed as if the people living in the innermost Walls almost forgot they were caged up, living like rats, pathetically hiding from their natural predators who ruled the territory outside the three Walls. Because of these Walls, which haven\'t been breached in over hundreds of years, humanity pretended that they were safe and sound inside, nobody had the idea to even step a foot outward… Except for the Survey Corps, who devoted their hearts and bodies to try and find the origin of these monsters known as titans, who seemingly only existed to make the lives of humans harder and shorter. Although their devotion was bold, no expedition outside the Walls succeeded, it only ever brought devastation.The next time YN felt intolerable pain was when she was seven. She had just gotten home from school, her father slouched on the couch, her mother closely behind him. YN slowly walked to her parents, her rucksack almost bigger than her. Mrs. Vögel helped her take off the backpack, sliding it off from her shoulders and arms."What\'s that?" heard YN her father\'s deep, alarming voice. He was eyeing her rolled-up sleeve, which happened to reveal a light pink bruise on her wrist. She didn\'t answer, just tilted her head down, so her hair fell forward and she was glancing at her own feet.Her father grabbed her hand lightly, inspecting the pink mark. "Did kids in school do this to you?" he asked low, and she just nodded. He brushed his fingers over the bruise. "How could you let them?" he murmured, clicking his tongue, lightly pressing on the bruise, causing YN to squirm. "Why didn\'t you fight back?" he questioned, pressing even more firmly with every word. "Do you want me to be embarrassed, that my daughter is this weak?" he scoffed, not only pressing the blister but wrapping his hand around the tiny wrist. "Pathetic" he coughed before letting go. The marks of his fingers stayed on for weeks.Her mother never really bothered to intervene when Mr. Vögel was furious. She would only clasp her palms together and stand back far, watching it with expressionless eyes. To be exact, Mrs. Vögel had no expression most of the time. She would nod at her husband\'s words, and answer shortly, but it looked as though the words never got registered in her brain.The last time her father placed hands upon YN was when she was fifteen. It was a warm, late summer evening, and Mr. Vögel had just gotten home from work. The maid quickly set up the dinner table as usual, and brought the food to the table, placing utensils as she moved. There were no words spoken until Mr. Vögel opened up his mouth."I agreed to let you marry a young politician," he stated, talking to YN but not looking at her."Hm?" she asked, clearly understanding what her father had said."You heard it right. The wedding won\'t take long. It\'s only good to strengthen my bond with my superiors, and also for the-" he rubbed his two fingers together, imitating money.YN placed her fork down. "No""What?""I\'m not marrying anyone.""It wasn\'t a request," he replied, his voice in the tone of a warning."I don\'t care" stood up YN, grabbing the edges of the table, but unconsciously stepping further away from the sitting man. "I\'m sick of you controlling my life.""While you\'re under my roof, I have the right to do so," he said standing up. It wasn\'t yelling, no, it was a booming voice that indicated aggression."You\'ve never been there for me, so why do you want to do something with me now?" she stepped even further away, completely far from the table. "I\'m only good when I\'m useful for you, huh?""Shut your mouth before I do it!" he screamed, furrowing his brows and bending his torso, getting closer to YN.\n"I\'m sick of you using me like a toy! A toy to beat, a toy to market off! I\'m sick of you!" she yelled back, her eyes getting watery. She never spoke to her parents like this. It was always small talk, paragraphs about her grades, or it was just her trying to endure the insults she got for breathing. But she couldn\'t take it anymore, not after this alleged marriage, she was fifteen for god\'s sake!"And I\'m sick of you talking back! I didn\'t raise you like this. Your duty as a girl… as a soon-to-be-married woman is to…" he got closer as he spoke, venom spitting from his tongue. Mrs. Vögel sat in the corner. He raised his hand and opened his fist, "to shut the fuck-" he swung, but there was no clapping sound.YN behaved without thinking, her heart beating in her throat, and her hands shaking as she grabbed onto the incoming arm. They stared at each other for an uncomfortable second, until she felt the bony knuckles of her father\'s curled-up fist blow in her cheekbone. She sensed her palm let go of the arm that she was holding, and flew against the oak door.\nAs she opened her eyes, her vision got blurry, and she could only see a distant blob breathing heavily. It was her father, probably. She didn\'t imagine a situation like this when she dreamt about a way to say no to her father. Her dreams never turned out this way, her against the door. The door. She gathered all her strength and heavily leaned against the entrance, quickly standing up, finding the handle, and twisting it. It was a now or never situation. She ran, her sides hurting, she ran, hearing her name being screamed out in the distance, she ran, not knowing where, to whom, how, but she ran straight in between the beautifully built houses, and the gorgeously shining moonlight.\n'], '2': ['\nChapter Text\n"Yeah, I waited half a day for the gate to be opened so I could sneak out. The MP wasn\'t looking for some reason so I just-" she threw her arm forward and made a "shhh" sound."And you chose to come here?" asked a boy, the same age as YN."I mean, I didn\'t know where to go… So I just ran and ran, until I saw this place." she raised her shoulders, and then dropped them down. "I mean at first it was kinda weird how they asked for my name and birthplace, who knew they would send me to the training corps?" she chuckled at herself and crossed her legs under her."And you gave out your personal information just like that?" Moblit opened his eyes wide in disbelief."And what about you guys?" YN ignored the horrified Moblit\'s question and looked around at the little group sitting beside her by the fire. "Oh, I come from a village just from the south!" answered Hange, their round glasses glistening in the fire. "I don\'t have any cool stories like you though."YN looked at the next person, who was sitting next to Hange. His dirty-blond bangs were parted in the middle, and even sitting down, he towered over everyone."I\'m from Karanes, Wall Rose," he said bluntly, and no matter how long YN looked at him with open eyes and raised eyebrows, he didn\'t say anything else, so she just nodded and muttered out a \'right!\'."Wall Rose too," said Nanaba when YN shifted her gaze at her."Right, and…" YN dragged her words far, not knowing how to keep the conversation going. The other kids were hardly saying anything, but that didn\'t bother her that much, at least Hange participated in babbling. "were you ever inside Wall Sina?" she asked."You need citizenship to go there, so…" raised one eyebrow Nanaba."Oh right, right" smiled YN as she rocked herself back and forth on her legs. "I mean it\'s not that big of a deal anyway. The buildings are nice, yeah, but the people…" she sighed a dramatic sigh. "Snobs, everyone, the women only care about marrying a great man and getting richer, and the men are… male… bitches." she raised her tone at the end as if she was asking. "Not to talk about the Military Police!" she leaned forward, ready to tell the others sitting around her everything she knew about the MP and their corruption."Are you trying to sabotage us?" asked Miche as YN almost spilled the worst secrets of the Military Police. "Huh?" she stopped, her face getting red in embarrassment. "What, no, no, I-""It seems like you were only saying that so we don\'t choose to fight for the top ten and go to the MP" continued the boy, his expression cold as ice. "What?" chuckled YN nervously. "I don\'t even know how this top ten grading system works, I would never-""Just a joke" smiled Miche, and YN felt her cheeks grow redder. She dropped her shoulders and dramatically fell back relived, while the others around her swarmed in laughter."Stop laughing and go to sleep!" they heard a voice creep behind them. The boy was the same age as them, maybe a little older, he had a sharp jawline and visible cheekbones."And who are you to tell us that?" asked YN, the smile from before still lingering on her face."Nile Dawk, and-""That name doesn\'t tell me anything," she raised her eyebrows."You know what YN, I agree with Nile here, it\'s late and we have our training tomorrow," declared Hange walking behind YN and wrapping an arm around her shoulder, pushing the girl forward towards their room. After they almost arrived at the barracks, Hange sighed. "Don\'t get into fights,""Why? Don\'t you want to see my super-efficient-amazing-show stopping combat moves?""Oh shut up" they laughed, throwing their head back. The round glasses they had on flying to the ground.                                                                                    *YN was an exciting person. Her presence alone made people either really relieved or really nervous. The first day of training, when they were practicing with the ODM gear, she kept joking and laughing around, causing the other fresh recruits to let out a sly smile here and there, but when it was her turn on the rope, she did it without hesitation or mistake.Most people would have said she was lucky that day, or that the stars were perfectly aligned just to help her succeed, but it wasn\'t the case. As time went by, and the training exercises got harder, she kept succeeding even more. She stayed on top as a physical fighter, her stamina increasing as the years went on, she got stronger and faster, more agile. She was reckless, and it was like she didn\'t fear anything, and this made all the other cadets a tad bit concerned. It seemed like she was ready to throw away her health and safety for the adrenaline rush.On days where the training consisted of killing titans made out of nicely carved wood, it was like she came to life again. The adrenaline was rushing through her veins, she glided through the trees with lightspeed, even with the strongest slices her blades stayed put and sharp. The only thing she lacked in was tracking her gas, it always ran out, and she was forced to change it in the middle of a fight. The instructor kept on scolding her for this. It was no doubt that she, Hange, and Miche made a great team. Hange was smart and fast, their thinking skills overpowering everyone, their decision helping the team come up with plans fast. Miche was agile and strong, he thought fast and acted fast. Lastly, YN was an ace. It was almost like she was born riding the ODM gear, and born holding these special blades designed to kill titans. She was insanely fast and wild, and this restless and recklessness bagged the team so many kills and chances.After their graduation, the remaining people of the cadet corps were required to choose a regiment they will continue at. The top ten best cadets would have a chance to change their lives and go relish in the interior as the members of the Military Police, the others had to choose between the Garrisons, who patrolled the city, took care of the citizens, and the three Walls, and the Survey Corps, who dedicated their lives to unfold the secrets of the titans."I told you I\'m not going to the Military Police," answered YN, her face unusually serious."Then what?" asked Hange, sitting beside her and drinking a bottle of beer."I can\'t choose, I might just flip a coin or something.""I’m joining the scouts," said Miche as he placed his bottle down on the table."I wonder where the others will go," said YN, turning in her seat and glancing at the somewhat familiar faces in the room. "I bet Nile will go to the MP, bastard," she commented out loud. "Rico, Ian, and Mitabi seem like Garrison types, Gelgar… I have no fucking idea, it feels like he would rather work in a brothel or something…""You should think about where you want to go instead," insisted Nanaba."Why do I have to make my own decisions?" cried out YN dramatically, and let her head fall forward, banging against the wooden table.When the night came, and they had to choose a regiment, YN felt weirdly calm. As the Instructor called out the names of the top ten, and she heard her name stand in the first place, she didn\'t feel like she achieved anything. She stood there, arms glued to her side, and as if she didn\'t care what was happening around her, her brain could only think about the next step.As the instructor stepped away, and gave place to a tall, lanky man, with dark eye bags and almost no hair, YN thoughts cleared up. He was wearing a drab green cape, and the same brown jacked everyone had, except on his stood two small wings crossing each other. Keith Sadies, the commander of the Survey Corps stood tall and told his speech to the cadets. His voice was harsh, but his words were reassuring, soliciting, and a hint of regret trailed on his words. It was like he didn\'t want anyone to join the Survey Corps, only if they had a death wish.When his last words were heard, YN felt as if her feet were glued to the ground. She saw groups of people leaving the place, when they walked past her, they looked her in the eyes in disbelief. She couldn\'t move, it was like her heart already decided for her. The majority of the people left, but she couldn\'t care less. She felt a reassuring arm wrap around her shoulders, they belonged to Hange. Miche, Nanaba, Moblit, and Gelgar stepped closer to her so they were standing in a line. As the commander pleaded for them to devote their hearts to the cause, YN\'s closed fist flew to her chest to salute.\n'], '3': ['\nChapter Text\nIt was rather unfortunate, that just after a few days of being an official member of the survey corps YN had to fight for her life.She could barely see anything from the big water droplets falling from the sky, and after a few minutes, she gave up trying to wipe her wet face and focused on staying on her horse. The scouts waited at the gate of Wall Maria in Shiganshina, for it to be opened.Although expeditions outside the Walls were necessary for humanity in the fight against titans, not only the scouts, the civilians dreaded it. 22 expeditions were made until that day, but none succeeded, nobody ever cheered for them to come back, because the only thing they brought were the dead bodies of those valiant soldiers.Nonetheless, a small crowd was formed around the few soldiers grabbing onto their horses. YN kept looking behind her to make sure Hange could see, considering their glasses kept getting wet, and they needed to wipe the rain off every ten seconds.The commander of the Survey Corps, Keith Shadies was a frightful person, to say the least. YN hasn\'t seen a titan yet, but she swore that he was scarier than any giant. And although he truly was an intimidating person, YN doubted that his looks alone would scare away any titan from attacking.When the scouts exited the Walls, nothing was unusual about the scenery, or the air, or the ground, or the trees. It was exactly the way it was inside. YN followed the veteran scouts who were galloping in front of her, and although no titans were near yet, she could feel the atmosphere change. It was almost like the commander had no idea what to do, and where to lead the scouts other than in the arms of their devastation.Unconsciously, YN kept looking left and right and behind, trying to find her companions and making sure they were doing okay. She couldn\'t understand why the commander chose a day like this, where not only the titans, but the weather was against them too. Not to mention, she didn\'t know where to go, only following the steps of the person in front of her, the scouts lacked formation and clear plans."A Titan, there!" she heard a voice yell from behind, and she followed the gaze of the man screeching. It was terrifying, not only did the rain and the fog make the sighting of nearby titans close to impossible, it added to their scariness. Compared to the drawings made in textbooks, and to the carved-out titans, the real ones made YN want to kill herself on the spot, so she couldn\'t see them anymore. It could\'ve been around 6 meters tall, its head floppily swaying around as it took steps towards the scouts, it didn\'t run, but the way its eyes were glued to the people underneath it made YN\'s blood freeze in her veins."Come on cadet, this way!" she felt somebody nudge her shoulders, and without hesitation, she followed the small group running west. There were four scouts plus her fleeing in this direction away from the titans, but she didn\'t identify them. Breaking her neck she looked back once more, trying to find a familiar face in the fog, but she couldn\'t.The person in front of her stopped for a moment, and YN looked their way puzzled."Wha-, why-" they mumbled. The recruit dropped the leash they were holding and froze for a second, glancing forward and bending their back."This is no time to stop!" YN yelled at the person and took a turn around the cadet. She couldn\'t feel the exact moment when, but something pushed her from the horse and carried away the cadet into the mist. As she tried to endure the pain of her aching back, she felt a sudden urge to move away. Not knowing why, she quickly rolled over to the side, and as she did, an enormous hand grabbed onto the ground where she lay just seconds ago.The fingers elevated from the ground and reached for her face. YN took out a pair of fresh blades, and while still weltering in the mud, she swayed the weapon, snapping the fingers off. A light dose of smoke arose, and she jumped to her feet quickly, shooting her anchors straight into the ankles of the giant bending across from her. As she slid closer to the muddy ground, she sliced the flesh around the titan\'s ankle, causing it to roar in pain and fall forward on its face. If it wasn\'t a life-threatening situation, she would\'ve laughed and commented on the stupidity of the titan, but the current conditions of her brain didn\'t allow it.Changing paths, she flew back to the titan laying face to face with mud, she shot an anchor in its shoulder, and while riding the wind, slid her two blades up against its neck."Hah, that\'s what you get for creeping up on a lady like that," she spat, but as she looked in the eyes of the now-dead titan slowly evaporating, a scream begging for life hit her ear. It was one of the soldiers near, and although YN couldn\'t see the person exactly, she saw one titan holding up its arm, a wiggling figure closed in its fist, which hung only centimetres away from its mouth."Gotcha," she whispered to herself and shot her anchor straight in the held-up arm of the titan. As she twirled the blades around, YN successfully cut off the arm, with the person trapped in it. It fell to the ground harshly, but YN didn\'t concentrate more on that. She slipped under the shoulder of the titan and quickly ran over its back with her blades digging in forcefully.Jumping away from the lifelessly falling creature, YN carefully roamed around in the blood-soaked grass, trying to find the man grasped in the titan\'s cut-off arm, hoping that he survived. Not long, she found the arm decaying on the ground, so she hopped there hastily, relieved that she could see the body lying between the skeleton-like fingers."Hey, are you-" she queried, pulling up the lying figure, only to find out she couldn\'t look him in the eyes, solely at the bloody open wound that stayed after decapacitation.She instantly dropped hold of the dead body and wiped her hands in her trousers, which were already dripping in blood."Help! Somebody!" she turned at the sound of a woman\'s voice begging, and she sprung towards the pleading person. The titan towering over the woman was rangy and tall, the skin hugging its ribs closely, it reminded YN of a decaying cat. YN shot her grappler on a nearby tree that was lankily bending in the wind, and from there she slid her blades against the leg of the titan. It was cut almost in a flash, the limb was too thin in the first place to endure the killing strike of the blade. The titan lost its balance and fell to its right, YN managed to rush up on its back to jump up, but as she twirled in the wind, her eyes caught the now dead body of the begging woman. YN destroyed the titan\'s nape as she fell back."Why am I late?" she whispered to herself, fighting against the scraping sensation in her throat. "Quick, cadet, get on the horse," urged a deep voice sitting high on his horse. The man kept his hood on, his usually slicked-back blond hair not visible anymore. His bushy eyebrows were furrowed, and his expression crumpled up.YN looked at the man hesitantly, her eyes falling back again to look at the bodies scattered around. Just when she was about to find her horse, she saw a huge figure running in the distance, straight towards the man."Squad leader!" she cried out and shot an anchor into the sprinting titan. The titan kept running, even when YN came closer, it was almost like it didn\'t take interest in killing the girl. YN grabbed onto the now dull and beat-up blades in her hands, and slid them towards the titan, cutting straight into the flesh on its arm. The blades split in half, and the titan came to sense, finally acknowledging the presence of YN. It reached towards the girl with its left hand, which was still intact, but YN managed to jump away, straight onto the face of a titan. She stabbed her broken blades into the eyes of the titan, feeling the blood spritz into her eyes and drip down her face. Reaching up, she ran on the top of the titans head, and as quickly as she could, changed to a new pair of blades. With her fresh razors, she slid down, finishing off the kill."Thank you, cadet. But we should go and find the commander," he watched as YN jumped back on her horse, and flicked the hood of the jacket forward."Squad leader," YN called out when they took steps forward towards a green smoke that had arisen. "When does an expedition end? Not that I would pass up this amazing time here, just curious.""Who knows?" he chuckled, the rainwater dripping in his mouth. "When the commander loses all his men,""Where are your men?" she wondered, speeding up so they were side by side."I came for them, but only found you," he mumbled.YN turned her face away from the man, her lips parting in mourn. "I\'m sorry. I couldn\'t save them," she whispered. "If only I was faster,""Don\'t lose heart because of this," he muttered offhandedly. "It\'s going to happen countless times, so many times you wouldn\'t even be able to count."YN couldn\'t possibly say anything, the image of the lifeless bodies withering amidst the mud and blood made her stomach twist, she never wanted to see anything like that ever again. She hated herself for believing that she could save anyone. Her hands were wet and frozen, gripping the leash. "Red smoke, titan sighted!" yelled out the squad leader, and YN\'s head shot up from glancing at the ground. "We go the opposite direction, turn!""But what about the green signal? They need help!" YN pulled the leash strongly, and her horse stopped."They\'ll manage, we have to find the commander," the man asserted, his voice deep, reminding YN of her father\'s alarming one, and a row of shivers ran down her spine."No way! I\'m not leaving anyone behind!" she leaned forward, and disappeared in the fog, going in the direction of the mush of the red and green smoke.Squad leader Erwin gently nudged his horse and followed in the path YN went.As YN got closer to the smoke signal, three huge figures were drawn out in the smog. All of them were bigger than the previous ones YN fought with, and around them were scouts swarming like flies.YN stood up on her horse, balancing on its back, and just when she got close enough to one titan\'s leg, she shot an anchor up its back. Luck was on her side, the titan didn\'t suspect a thing when she ran up against its spine, and struck at the weak point. As she left the collapsing titan, she recognised a face fighting just across her.She reached to the man, and while jumping away from an incoming arm, she yelled out. "Changed your mind, squad leader?""Couldn\'t let you die, could I?" he boasted, as he slid his blades against the nape of the titan."Okay, one more" YN breathed out and searched for the last titan. "Hange?" she stopped after catching a glimpse of a person flying around.Hange was hovering around one of the titans, struggling to cut any part, it almost looked as if they didn\'t want to touch it."Hange? Hello?" YN called out, as she slid through the air, and landed on the knee of the titan. Digging her blades into its flesh, she ran upwards, dragging the swords after her, leaving trails of blood on the titan\'s leg. "YN! I\'m so glad you\'re here, look at this titan-" they leaned closer to the giant, and just like that, the titan grabbed their body, crushing it, and violently shaking it.YN jumped away from the titan\'s body, and in shock, flew straight towards her friend. Around half an hour ago, she made the mistake of not running direct at the hand of the titan, which cost a scout\'s life. She couldn\'t allow herself for that to happen again. Slicing the fingers of the titan vigorously smiling at Hange, she grabbed onto the falling body and landed on the ground. A spinning slash came from behind, and Erwin docked beside YN."Stealing my kills, squad leader?" YN raised an eyebrow, but her eyes were glued on Hange, who was sitting in her arms."Somebody has got to better the statistics," he responded and turned his head towards an incoming horse."Thanks, thanks YN" Hange chuckled, brushing away YN\'s wrapping arms and standing up from her grip, leaving the girl puzzled with dropped shoulders."Retreat!" yelled commander Sadies, who was indeed the man coming on horseback. He shot out a green smoke signal towards the south, and with the rest of the men, withdrew towards Wall Maria.As they galloped back to the Wall, the remaining soldiers joined with the small group following the Commander. YN kept looking out for familiar faces, and a stone dropped from her heart when she found Miche, Nanaba, and Gelgar coming back safely.Before she took a turn to greet the lost soldiers, a strong hand grabbed her shoulders. "After we reach the Walls, come and find me," Erwin ordered and took his palm from her. YN nodded continuing her way to the scouts."Look who\'s alive!" she blurted out as soon as she got close to her friends, and although their grimace didn\'t fade away, they all gave YN a slight smile. Miche sniffed. YN didn\'t say anything else, sensing that her constant blabbering would only worsen the mood of the melancholic soldiers, so she kept her pace in silence.The number of the soldiers coming back to Shiganshina was pathetic. A handful of new recruits and some veterans gave their lives again, just so commander Shadies could check off the 22nd expedition beyond the Walls on paper, and next month do the same thing. The crowd around the scouts has formed again as they entered the gate and gloomily ambled away. Family members, friends, and acquaintances waited for soldiers who never came back, and it was deplorable, the way nobody had the strength to tell them the way they died.YN lowered her head, and dragged her horse through the crowd, trying to find Squad Leader Erwin. She didn\'t say anything when she reached him, the two of them walking beside each other."As far as I know, you\'re from Wall Sina," he stated. YN nodded. "Have you ever been to the Underworld?"YN snorted lightly. "Like anyone would want to go there, sir. No, I haven\'t.""It is a rather pathetic place, isn\'t it? Still, I have some business down there,""Don\'t tell me you\'re selling something illegally, sir," she smirked."Not of that sort, YN" he looked down at her. "I\'ve seen the way you move with that ODM gear, and I heard from reports you\'re excellent at hand-to-hand combat.""I won\'t deny that, sir.""Good. I would certainly like to have you on the next scout mission," he said as they walked amidst the crying crowd."In the Underworld, correct?" she asked."You catch on quick," he said and nodded. "I\'ll take that as a yes, cadet. Rest as much as you can tomorrow, but find me in the evening."\n'], '4': ['\nChapter Text\nYN\'s back hurt from leaning forward on the horse, and her head ached sinfully. Trying to follow squad leader Erwin\'s advice she laid her body down to rest, but her mind didn\'t let her. A rush of excitement and curiousness took over her body every time she thought about the next mission she was invited to.The underworld was truly a disgusting place, so disgusting in fact, that nobody ever talked about it. YN\'s father would sometimes mention a thing or two about the people who lived like dogs, amidst their own shit and filth beneath the territory of Wall Sina, but that was YN\'s only knowledge. Now, she didn\'t understand why the squad leader invited her, or why he had things to do in the underworld, but she chose to push away these thoughts and tried to focus more on resting.She didn\'t trust the squad leader yet, his eyes unreadable and his thoughts unthinkable for anyone but him, he was one of a kind. When talking to him, YN felt like she was reaching for nothing in the dark. His expressionless face after hearing the news of losing all of his squad, and his stubbornness, which showed when he insisted on not going towards the green smoke made YN want to be cautious around him. But even after all of this, YN couldn\'t deny that he was a great leader and a clever man, she respected him.As the sun slowly went down, and the red light of it shone through the window, YN sat up on the edge of her bed, stopping her hour-long daydreaming. Hange sat at their desk, their knees pulled up high on the chair, resting under their chin. They were seemingly lost in their thoughts as they flipped through the yellow pages of an old book."Whatcha doing?" YN asked as she walked up behind Hange, grabbing their shoulders and forcefully massaging them."What does it look like?" they asked, smiling when they turned back to face the girl still digging her palms into their shoulders."Have fun looking at those letters… I\'m going, I don\'t know when I\'ll be back though," she said as she let go of the sitting person."The rendezvous you told me about?""Correct"\xa0---\xa0"Correct, this mission will take place in the underworld," Erwin said as he stood behind a desk, papers and ink scattered around messily. YN stood next to Miche, at the corner of the desk and listened to the squad leader blabber about the instructions. In all honesty, the dead flower in the office\'s window took all her attention from the plan. Other than the three of them, there were two more veteran scouts and three military police officers."The names are unfortunately unknown, but we do have rough sketches of their faces," the squad leader stated, pointing at three papers laying on the desk. YN immediately reached for them and studied the drawings."This one looks like a little kid, he looks acceptable, and he… well I don\'t know if the artist ran out of imagination, patience, or if he purposely drew this man like this, but…" she smirked, passing the drawing to one the MP men."Our mission is to capture them, you can harm them if it\'s necessary, but the priority is capturing," "I heard they also know how the use the maneuvering gear," one of the scouts added to the conversation."Correct, that\'s why their capture won\'t be easy," Erwin replied. "And that\'s why I invited her," he extended his palm to slightly point at YN. "I\'m pretty sure by now you have all heard of cadet Vögel, her skills are almost leveling ones of the veterans, despite being only a new recruit.""No need for flattery," YN plopped her palm down. "But I won\'t deny.""When do we get going?" Miche asked, impatiently tapping the floor.A carriage stopped straight before the squad leader\'s office, and he stood up, correcting his deep green cape. "Now."Before heading out of the building, YN grabbed onto the ugly man\'s portrait and crumpled it inside her jacket\'s pocket.She never thought she would enter the gates of Sina ever again, the sight of the too elegant and pretty buildings making her stomach turn. She looked away from the window, meeting eyes with Miche, who glanced at her as if he read her mind and sniffed. The carriage slowly turned away from the nicely built buildings and continued its way into a smaller street, a rather nasty one compared to the others in Wall Sina. The carriage suddenly stopped, and after the squad leader made his exit opening the door, YN followed him. The wind was chilly and fresh, hitting YN\'s exposed cheeks and hands. One of the MP men staggered to the corner of the street and opened a tiny entrance in the ground, the quick motion of it causing dirt to erupt into his face.Following the scouts, YN took the stairs down, and as soon as the entrance was blocked again, an uncomfortable punch pushed her guts around. She kept gasping for the dirty air, the whole place trailed of shit and decaying bodies, it was devastating how people actually lived there."The thugs we\'re looking for won\'t be far away," Erwin stated. "You go first, we\'ll come behind," he looked at the military policemen. "And you do as I explained," he turned his head to YN. She nodded.From around 200 metres away, clapping of barrels and wooden boxes, and the growling of men was heard. The three military policemen immediately sprung towards the sound, the scouts following them. YN, per the squad leader\'s order, stayed back for a minute and took a detour to the right, still following the soldiers, but not letting herself be seen. She watched from behind as the scouts sprinted quickly over to three flying figures, who were also maneuvring with the ODM gear. The squad leader specifically told her, and Miche to ignore the two other thugs, and go straight for their leader. YN followed through the roofs and caught a glimpse of the man, who was supposed to be their leader. She couldn\'t see his face, merely the colors of his clothes and hair. From behind, she dashed to him, making sure he didn\'t notice her. He was being chased by Miche, and another scout, but surprisingly, he left both of them metres behind. YN congratulated him in her head, he was amazing at flying, but she couldn\'t let him beat her. His observational skills were astonishing, ditching every attack that came towards him, and although the scouts weren\'t used to fighting real people, following a moving target shouldn\'t have been hard for them. Even though his reading of the situation was great, YN still managed to sneak up behind him, and as he entered a house, breaking the windows and leaving a scout behind, YN got to him, quick as lightning. He froze for a moment in shock, letting YN wrap her arms around his throat, squeezing it softly. Bringing him to the mud, he tried to escape her grip by using his hands and grappling away by using the ODM gear, but with her available hand, YN pinned the man\'s arms behind his back. He groaned in pain, and as if the painful response made something click in her brain, YN softened her grip, almost letting go of him. Lucky for her, Miche was standing next to the two of them on the ground and took over the handling of the man."Don\'t struggle, it won\'t help anything," Miche said and held the man close to the swampy ground. The thug stared up from the dirt and looked around, seeing how his comrades have been caught too.He gave up the struggle, and kept his head up, gazing at Erwin. YN studied his face for a moment, his sickly white skin that almost looked dead, his sharp, straight nose, his fairly thin lips that were parted in exhaustion, his acute jawline that was covered in mud, and his hair that was shaven in an undercut, the top part falling in his face."Who taught you to use the maneuvring gear? Did you get military training?" Erwin urged but got no answer. Miche grabbed onto the man\'s hair and plastered his face into the mud."Look, no one taught us!" the blond thug being held back by a scouts grip answered."We\'re self-taught!" the girl continued, her voice blinging proudly."And where did you get them?" Erwin questioned, his eyes never leaving the black-haired man on the ground."We borrowed them," The girl continued, and YN couldn\'t help but smile at the innocently phrased answer."What\'s your name?" Erwin insisted lastly."I\'m Furlan Church," the blond answered, a weird wave of confidence lingering around him."Isabel Magnolia!" the little girl smiled, almost like she was talking to a kindergarten teacher who just asked her to introduce herself to the class."Levi," the man on the ground growled, spitting the mud that got into his mouth, his voice deep a low."You have exceptional skills," Erwin knelt down to the ground, so he was face to face with Levi. Miche let the man on the ground have a little bit of freedom. "I have an offer for you. The Military Police will be ready to forget all your crimes, only if you join the Survey Corps," he stated and offered his hand.Levi looked around for a minute, obviously looking at Furlan\'s and Isabel\'s expressions, but they seemed content, so Miche let go of him, and he shook hands with the squad leader.As Erwin stood up, Miche let Levi straighten his back, YN heard the crack of his spine and made a distorted face. The scouts, along with the MP marched back to the entrance of the underworld.YN slowly stepped in the direction of Miche who was monitoring Levi."If it helps anything," she reached in her jacket\'s pocket. "You don\'t look as ugly in real life as you do in the official sketches of the military police," she showed Levi the drawing she stole from Erwin\'s office. He stared at the drawing, and then back to YN with annoyance in his eyes, which almost made YN\'s cheeky smile disappear.\xa0---\xa0The difference between the life in the underworld, and the life inside the Walls was soon shown by the three new recruits. Isabel, Furlan, and Levi were different from the rest, they already knew what it was like to fight for your life, to have nothing, and to lose everything.Keith Sadies, the commander of the Survey Corps sent them to extra training every day for the next two months, they were required to complete an as high level of training as the other cadets did in three years. To squad leader Erwin\'s suggestion, the three new recruits were assigned to YN when training with the titan dummies, and this action showed everyone in the scouts that YN\'s future was already secure.YN as an also fresh soldier couldn\'t talk about the titans the way a veteran soldier could, only being on one excursion, but that didn\'t stop her from acting like she was the leader of every single expedition made outside the walls. "The most important thing is to slice the part one meter long, ten centimetres wide at their necks," she explained to them on their first training. "Please tell me you know how centimetres work," she added as she found Furlan looking at her puzzled. Isabel shook her head."Okay, yeah, no problem," YN sighed and smiled. "I\'ll just show you, we can leave the theoretical aspects of the training to somebody else."YN walked deeper into the training grounds, leaving the sand-covered terrains, and pacing towards the near forest, dragging a bag with herself as she went. The three recruits followed her. When she reached the forest, she dropped the sack to the ground and opened it, revealing 12 pairs of fresh blades. "Originally they wanted to give me only half of this, but I went and stole more," she chuckled to herself as she threw three pairs of blades under everyone\'s legs. Isabel smiled politely as she watched YN fiddle with the blades."Right, so these are the blades that we use against the titans. You already know how these work," she clasped her handgrips and raised them. "You aim, and shoot the grapple towards where you want it to hook in. Next are these boxes," she tapped the metal crates connected to her thighs. Furlan looked her up and down, his stare staying strangely too long on her legs. "This is where the blades go," she explained briefly, not wanting to bore the others to death."Okay, enough of talking, change your blades, and let\'s go," she clasped her palms together, earning a nod from Furlan, an excited smile from Isabel, and an annoying glance from Levi, who showed no enthusiasm in participating."Blades aren\'t meant to be held backward," YN raised her left eyebrow when she saw Levi rotating his blades, so his pinky was resting on the trigger. "Your pinky isn\'t even strong enough to press onto the trigger with enough force, and-""As long as it works, don\'t tell me what to do," he answered, causing YN to burst out in a smile and raise her two hands in front of her in defence.YN nodded and led them into the woods. "A forest is great, cuz\' you have a lot of things to grip into," she explained, looking around at the trees. She stopped at the feet of a big, wooden carved-out titan, with a bag plastered on its neck. "Of course titans don\'t look like this, the first time I saw them I didn\'t know if I should cry or laugh," she mumbled. "Now, I\'ll demonstrate, and you observe!"YN got a hold of her grapples, and swiftly aimed herself on top of a tree, from above, she jumped under, digging the swords into the little sack filled with sand roped to the titan\'s neck, cutting it deeply, and landing on her feet. "Not hard, eh?" she smiled at an excited Isabel pacing around."Right, let\'s go around and kill the rest," Furlan said smiling and fisting his two hands together. YN nodded and sprung away from the three fresh soldiers on the ground.Their training lasted around two hours, and if their blades didn\'t all break into tiny pieces, and Keith Sadies along with some other soldiers and MP men didn\'t come to observe how the training went, they may have kept going for hours. YN managed to communicate with Isabel and Furlan in an instant, they followed her instructions and listened to what she had to say. Levi on the other hand seemed to only go after his own head, but nonetheless, he shocked YN with his raw talent."Bravo, bravo!" Hange clapped from below after Levi struck one of the sacks. YN jumped down from a tree laughing and wiped the sweat from her forehead, Furlan, Levi, and Isabel following her to the crowd below them."Commander," YN greeted as she got face to face with Keith Shadies, saluting to the man."He doesn\'t hold his blades right," criticised one of the Military Policemen Levi, who was standing next to Furlan, gripping his swords. YN recognised the man\'s face from before, but she couldn\'t guess his name even if she tried to, he was probably one of her father\'s drinking buddies."How innovative!" Hange jumped up in excitement, and YN couldn\'t help but give them a sly smile."Vögel, thoughts?" squad leader Erwin appeared from behind the crowd, and YN furrowed her brows as to how she didn\'t notice the large blond man."A lot of potential in all of them, great physical and mental skills," she straightened her back and placed her right hand on her heart."Make sure they\'re ready for the next expedition," he ordered, and YN nodded, and turned her head to face the three soldiers, who were all standing with their fists on their chests. YN turned back and gave Erwin a sly smile, but she couldn\'t decide if the corner of the squad leader\'s twitched back or not.\n']}}]
#
# testdb = Database_Class('FF_Data_Cluster')
# testdb.add_to_database(testpackage, 'collectedData')